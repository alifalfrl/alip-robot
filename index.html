<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Alip AI & Downloader - Cerdas & Premium</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        /* CSS Umum */
        :root {
            --bg-primary: #1a1a1a;
            --bg-secondary: #2c2c2c;
            --text-color: #f0f0f0;
            --border-color: #444;
            --accent-color: #4CAF50;
            --grad-1: #4caf50;
            --grad-2: #8bc34a;
        }
        
        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--bg-primary);
            color: var(--text-color);
            margin: 0;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background-image: linear-gradient(135deg, var(--grad-1), var(--grad-2));
            background-size: 400% 400%;
            animation: gradientAnimation 15s ease infinite;
        }
        
        @keyframes gradientAnimation {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        .container {
            width: 95%;
            max-width: 768px;
            background-color: var(--bg-secondary);
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            overflow: hidden;
            display: flex;
            flex-direction: column;
            min-height: 90vh;
            border: 1px solid var(--border-color);
        }
        
        header {
            padding: 24px;
            text-align: center;
            border-bottom: 1px solid var(--border-color);
        }
        
        header h1 {
            margin: 0;
            font-size: 2em;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
        }
        
        .profile-pic {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            border: 2px solid var(--accent-color);
        }
        
        .sub-header {
            font-size: 0.9em;
            color: #aaa;
            margin-top: 8px;
        }
        
        #main-content {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            position: relative;
        }
        
        /* Gaya untuk Chat AI */
        .message {
            display: flex;
            gap: 10px;
            align-items: flex-start;
            max-width: 85%;
            margin-bottom: 15px;
            animation: fadeIn 0.5s ease-in-out;
        }
        
        .message-content {
            padding: 12px 18px;
            border-radius: 18px;
            word-wrap: break-word;
            line-height: 1.6;
        }
        
        .user-message {
            align-self: flex-end;
            justify-content: flex-end;
        }
        
        .user-message .message-content {
            background-color: var(--accent-color);
            color: var(--text-color);
            border-bottom-right-radius: 4px;
        }
        
        .bot-message {
            align-self: flex-start;
        }
        
        .bot-message .message-content {
            background-color: #3a3a3a;
            color: var(--text-color);
            border-bottom-left-radius: 4px;
        }
        
        .avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            object-fit: cover;
        }
        
        .typing-indicator {
            padding: 10px;
            color: #aaa;
            animation: pulse 1.5s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 0.5; }
            50% { opacity: 1; }
        }

        .video-container {
            margin-top: 10px;
            display: block;
        }

        .video-container video {
            width: 100%;
            border-radius: 12px;
            background: #000;
        }

        .download-guide {
            margin-top: 10px;
            font-size: 0.9em;
            color: #ccc;
            background: #3a3a3a;
            padding: 10px;
            border-radius: 8px;
        }
        
        /* Input & Tombol */
        #inputArea {
            display: flex;
            padding: 15px;
            border-top: 1px solid var(--border-color);
            gap: 10px;
        }
        
        #prompt {
            flex: 1;
            padding: 12px 18px;
            background-color: var(--bg-primary);
            color: var(--text-color);
            border: 1px solid var(--border-color);
            border-radius: 25px;
            font-size: 1em;
            transition: border-color 0.3s ease;
        }
        
        #prompt:focus {
            outline: none;
            border-color: var(--accent-color);
        }
        
        #sendBtn {
            padding: 0 24px;
            background-image: linear-gradient(to right, var(--grad-1), var(--grad-2));
            color: #fff;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        
        #sendBtn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(76, 175, 80, 0.4);
        }
        
        #sendBtn:active {
            transform: translateY(0);
            box-shadow: none;
        }
        
        footer {
            padding: 12px;
            text-align: center;
            font-size: 0.8em;
            color: #888;
            border-top: 1px solid var(--border-color);
        }
        
        /* Scrollbar Stylings */
        #main-content::-webkit-scrollbar { width: 8px; }
        #main-content::-webkit-scrollbar-track { background: var(--bg-secondary); }
        #main-content::-webkit-scrollbar-thumb { background: #555; border-radius: 4px; }
        #main-content::-webkit-scrollbar-thumb:hover { background: #777; }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body>
<div class="container">
    <header>
        <h1><img src="https://img1.pixhost.to/images/8232/635013559_media.jpg" alt="AI Profile" class="profile-pic"></h1>
        <p class="sub-header">AI & Downloader oleh <a href="https://instagram.com/alifalfrl" style="color:var(--accent-color); text-decoration:none;">@alifalfrl</a></p>
    </header>
    <div id="main-content">
        <div id="messages" class="active"></div>
    </div>
    
    <div id="inputArea">
        <input type="text" id="prompt" placeholder="Ketik pesan atau tempel link video...">
        <button id="sendBtn">Kirim</button>
    </div>
    <footer>Â©alipclutch</footer>
</div>

<script>
    const messagesEl = document.getElementById('messages');
    const promptInput = document.getElementById('prompt');
    const sendBtn = document.getElementById('sendBtn');
    const botAvatarUrl = 'https://img1.pixhost.to/images/8232/635013559_media.jpg';
    
    // Prompt sistem untuk AI
    const systemPrompt = `Kamu adalah Alip AI, asisten pintar yang dibuat oleh Alif Alfarel. Jawablah dengan sopan, jelas, dan langsung ke inti, dengan gaya profesional namun tetap ramah. Selain bisa diajak ngobrol dan curhat, kamu juga mampu mendeteksi link dari TikTok, Instagram, atau Pinterest untuk membantu mengunduh video. Jika link tidak didukung atau proses download gagal, jawab dengan penjelasan singkat dan sopan.`;
    
    function addMessage(content, sender, isVideo = false) {
        const messageContainer = document.createElement('div');
        messageContainer.classList.add('message');
        if (sender === 'user') {
            messageContainer.classList.add('user-message');
        } else {
            messageContainer.classList.add('bot-message');
            const botAvatar = document.createElement('img');
            botAvatar.src = botAvatarUrl;
            botAvatar.alt = 'AI Avatar';
            botAvatar.classList.add('avatar');
            messageContainer.appendChild(botAvatar);
        }
        
        const messageContent = document.createElement('div');
        messageContent.classList.add('message-content');
        
        if (isVideo) {
            messageContent.innerHTML = content;
        } else {
            messageContent.textContent = content;
        }
        
        messageContainer.appendChild(messageContent);
        messagesEl.appendChild(messageContainer);
        messagesEl.scrollTop = messagesEl.scrollHeight;
    }
    
    let isTyping = false;
    let typingIndicator = null;
    
    function showTypingIndicator() {
        if (isTyping) return;
        isTyping = true;
        typingIndicator = document.createElement('div');
        typingIndicator.classList.add('message', 'bot-message', 'typing-indicator');
        typingIndicator.innerHTML = '<img src="' + botAvatarUrl + '" alt="AI Avatar" class="avatar"> <div class="message-content">...</div>';
        messagesEl.appendChild(typingIndicator);
        messagesEl.scrollTop = messagesEl.scrollHeight;
    }
    
    function hideTypingIndicator() {
        if (!isTyping) return;
        isTyping = false;
        if (typingIndicator) {
            typingIndicator.remove();
            typingIndicator = null;
        }
    }
    
    async function askAlipAI(query) {
        if (!query?.trim()) return 'â Mana promptnya?';
        
        showTypingIndicator();
        
        try {
            const finalQuery = systemPrompt + " " + query;
            const url = 'https://api.siputzx.my.id/api/ai/bard?query=' + encodeURIComponent(finalQuery);
            const res = await fetch(url, { headers: { 'accept': '*/*' } });
            
            hideTypingIndicator();
            
            if (!res.ok) {
                return `â Gagal menghubungi API: Status ${res.status}`;
            }
            
            const data = await res.json();
            let answer = data.data || 'â Alip AI bingung nih, coba tanya lain!';
            
            answer = answer.replace(/\n+/g, ' ').substring(0, 1000).trim();
            return answer;
        } catch (e) {
            console.error(e);
            hideTypingIndicator();
            return 'â Gagal memproses prompt, cek koneksi Anda.';
        }
    }
    
    async function downloadMedia(link) {
        const downloadUrl = 'https://auto-download-all-in-one.p.rapidapi.com/v1/social/autolink';
        
        try {
            const res = await fetch(downloadUrl, {
                method: 'POST',
                headers: {
                    'accept-encoding': 'gzip',
                    'cache-control': 'no-cache',
                    'content-type': 'application/json; charset=utf-8',
                    'x-rapidapi-host': 'auto-download-all-in-one.p.rapidapi.com',
                    'x-rapidapi-key': '1dda0d29d3mshc5f2aacec619c44p16f219jsn99a62a516f98'
                },
                body: JSON.stringify({ url: link })
            });
            
            const data = await res.json();
            
            if (!data || !data.medias || data.medias.length === 0) {
                return { success: false, message: 'â Gagal mendapatkan video. Coba link lain atau pastikan link publik.' };
            }
            
            const media = data.medias[0];
            const videoHtml = `
                <div>
                    <p style="font-size: 0.9em; margin-bottom: 10px; color: #ccc;">Berhasil! Video siap diputar:</p>
                    <div class="video-container">
                        <video controls>
                            <source src="${media.url}" type="video/mp4">
                            Browser Anda tidak mendukung tag video.
                        </video>
                    </div>
                    <div class="download-guide">
                        <strong>Cara Download:</strong> Klik ikon titik tiga (â®) di video lalu pilih Download.
                    </div>
                </div>
            `;
            return { success: true, content: videoHtml };
        } catch (err) {
            console.error(err);
            return { success: false, message: 'â Terjadi kesalahan saat mengunduh. Silakan coba lagi nanti.' };
        }
    }
    
    // Fungsi utama untuk memproses input
    async function handleInput() {
        const query = promptInput.value.trim();
        if (!query) return;
        
        addMessage(query, 'user');
        promptInput.value = '';
        
        const urlRegex = /^(http|https):\/\/[^ "]+$/;
        
        if (urlRegex.test(query)) {
            // Jika input adalah link, proses sebagai unduhan
            addMessage('Saya mendeteksi ini adalah link video. Sebentar, saya akan coba unduh untuk Anda... â³', 'bot');
            const result = await downloadMedia(query);
            if (result.success) {
                addMessage(result.content, 'bot', true);
            } else {
                addMessage(result.message, 'bot');
            }
        } else {
            // Jika input bukan link, proses sebagai chat AI
            const reply = await askAlipAI(query);
            addMessage(reply, 'bot');
        }
    }
    
    sendBtn.addEventListener('click', handleInput);
    
    promptInput.addEventListener('keypress', e => {
        if (e.key === 'Enter') handleInput();
    });

    // Pesan sapaan awal
    window.onload = () => {
        addMessage('Halo! Saya Alip AI, AI yang bisa diajak ngobrol dan juga bisa mengunduh video dari berbagai platform. Silakan ketik pesan atau tempel link video yang ingin Anda unduh. ð', 'bot');
    };

</script>
</body>
</html>
